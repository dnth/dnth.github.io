document.addEventListener("DOMContentLoaded",function(){const r=document.querySelectorAll(".floating-toc .toc-link"),i=document.querySelectorAll("h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]"),e=document.getElementById("floating-toc"),m=document.getElementById("toc-handle"),t=document.createElement("button");t.textContent="▼",t.style.cssText="position: absolute; top: 5px; right: 5px; background: none; border: none; font-size: 16px; cursor: pointer;",e.insertBefore(t,e.firstChild);const s=document.createElement("div");for(s.id="toc-content";e.childNodes.length>1;)s.appendChild(e.childNodes[1]);e.appendChild(s);let n=!0;t.addEventListener("click",function(){n=!n,s.style.display=n?"block":"none",t.textContent=n?"▼":"▲"}),console.log("TOC Links:",r.length),console.log("Sections:",i.length);function a(){let e=window.scrollY;console.log("Scroll position:",e),i.forEach(t=>{t.offsetTop<=e+100&&(console.log("Current section:",t.id),r.forEach(e=>{e.getAttribute("href")==="#"+t.id?(console.log("Activating link:",e.getAttribute("href")),e.classList.add("active"),e.style.backgroundColor="yellow"):(e.classList.remove("active"),e.style.backgroundColor="")}))})}window.addEventListener("scroll",a),a();let o=!1,c,l,d,u;m.addEventListener("mousedown",f),document.addEventListener("mousemove",p),document.addEventListener("mouseup",g);function f(t){o=!0,c=t.clientX,l=t.clientY,d=e.offsetLeft,u=e.offsetTop,e.style.willChange="left, top"}function p(t){if(!o)return;t.preventDefault();const n=t.clientX-c,s=t.clientY-l;e.style.left=`${d+n}px`,e.style.top=`${u+s}px`}function g(){o=!1,e.style.willChange="auto"}function h(){const s=e.getBoundingClientRect(),o=window.innerWidth-s.width,i=window.innerHeight-(n?s.height:t.offsetHeight);s.left<0&&(e.style.left="0px"),s.top<0&&(e.style.top="0px"),s.left>o&&(e.style.left=`${o}px`),s.top>i&&(e.style.top=`${i}px`)}window.addEventListener("resize",h),h()})